<Window x:Class="EmojiWifiWindows.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:EmojiWifiWindows.ViewModels"
        xmlns:models="clr-namespace:EmojiWifiWindows.Models"
        mc:Ignorable="d"
        Title="Emoji Wifi" Height="700" Width="950"
        WindowStartupLocation="CenterScreen"
        Background="#F3F3F3">

    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        
        <!-- Colors -->
        <SolidColorBrush x:Key="AccentColor" Color="#007AFF"/>
        <SolidColorBrush x:Key="SidebarBackground" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="ContentBackground" Color="#F5F5F7"/>
        <SolidColorBrush x:Key="TextPrimary" Color="#1D1D1F"/>
        <SolidColorBrush x:Key="TextSecondary" Color="#86868B"/>

        <!-- Text Styles -->
        <Style TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI Variable Display, Segoe UI"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
        </Style>

        <!-- Sidebar Navigation RadioButton Style -->
        <Style x:Key="NavButtonStyle" TargetType="RadioButton">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="Margin" Value="0,2"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#F5F5F5"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#E5F1FF"/>
                                <Setter Property="Foreground" Value="{StaticResource AccentColor}"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern Button Style -->
        <Style TargetType="Button">
            <Setter Property="Background" Value="{StaticResource AccentColor}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="5" ShadowDepth="2" Opacity="0.2" Color="#007AFF"/>
                            </Border.Effect>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#0062CC"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#0051A8"/>
                                <Setter TargetName="border" Property="Effect" Value="{x:Null}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Input Box Style -->
        <Style TargetType="TextBox">
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="6">
                            <ScrollViewer x:Name="PART_ContentHost"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource AccentColor}"/>
                                <Setter TargetName="border" Property="BorderThickness" Value="2"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Card Style -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0,10"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.05" Color="Black"/>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>

    <Grid Background="{StaticResource ContentBackground}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="260"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <Border Background="{StaticResource SidebarBackground}" BorderBrush="#E5E5E5" BorderThickness="0,0,1,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- App Header -->
                <StackPanel Grid.Row="0" Margin="24,30,24,20">
                    <TextBlock Text="EmojiWifi" FontSize="26" FontWeight="Bold" Foreground="{StaticResource TextPrimary}"/>
                    <TextBlock Text="v1.0 Windows" FontSize="12" Foreground="{StaticResource TextSecondary}" Margin="2,4,0,0"/>
                </StackPanel>

                <!-- Navigation -->
                <StackPanel Grid.Row="1" Margin="12,0">
                    <RadioButton x:Name="NavGenerate" Content="Generate WiFi" IsChecked="True" GroupName="Nav" Style="{StaticResource NavButtonStyle}" Tag="Generate"/>
                    <RadioButton x:Name="NavOptions" Content="Password Options" GroupName="Nav" Style="{StaticResource NavButtonStyle}" Tag="Options"/>
                    <RadioButton x:Name="NavCombinations" Content="View Combinations" GroupName="Nav" Style="{StaticResource NavButtonStyle}" Tag="Combinations"/>
                    <RadioButton x:Name="NavImport" Content="Import QR Code" GroupName="Nav" Style="{StaticResource NavButtonStyle}" Tag="Import"/>
                </StackPanel>

                <!-- Current WiFi Status -->
                <StackPanel Grid.Row="3" Margin="20,0,20,30">
                    <TextBlock Text="Current WiFi" FontWeight="SemiBold" FontSize="12" Foreground="{StaticResource TextSecondary}" Margin="4,0,0,10"/>
                    
                    <Border Background="#F0F7FF" CornerRadius="8" Padding="12">
                        <StackPanel>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Network" FontSize="11" Foreground="{StaticResource TextSecondary}"/>
                                <ContentControl Visibility="{Binding GeneratedWifiName, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <TextBlock Text="Active" FontSize="10" Foreground="Green" FontWeight="Bold" HorizontalAlignment="Right"/>
                                </ContentControl>
                            </Grid>
                            
                            <TextBlock Text="{Binding GeneratedWifiName}" FontFamily="Segoe UI Emoji" FontSize="16" Margin="0,4,0,8" TextTrimming="CharacterEllipsis"/>
                            
                            <Rectangle Height="1" Fill="#E0E8F0" Margin="0,0,0,8"/>
                            
                            <TextBlock Text="Password" FontSize="11" Foreground="{StaticResource TextSecondary}"/>
                            <TextBlock Text="••••••••••••" FontSize="12" Margin="0,2,0,0" Foreground="{StaticResource TextPrimary}"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Content Area -->
        <Border Grid.Column="1" Padding="40">
            <Grid>
                <!-- Generate View -->
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Width="450">
                    <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsChecked, ElementName=NavGenerate}" Value="True">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>

                    <TextBlock Text="Generate WiFi" FontSize="28" FontWeight="SemiBold" HorizontalAlignment="Center" Margin="0,0,0,30"/>

                    <Grid Margin="0,0,0,25">
                         <Grid.ColumnDefinitions>
                             <ColumnDefinition Width="*"/>
                             <ColumnDefinition Width="Auto"/>
                         </Grid.ColumnDefinitions>
                         
                         <StackPanel>
                             <TextBlock Text="Style" FontSize="12" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,6"/>
                             <ComboBox SelectedIndex="{Binding SelectedStyle, Mode=TwoWay}" Padding="10,8" FontSize="14" BorderThickness="1" BorderBrush="#E0E0E0">
                                  <ComboBoxItem Content="Emoji Combination"/>
                                  <ComboBoxItem Content="Single Emoji"/>
                                  <ComboBoxItem Content="Random Length"/>
                             </ComboBox>
                         </StackPanel>
                    </Grid>

                    <!-- Main Generated Result Card -->
                    <Border Style="{StaticResource CardStyle}">
                         <StackPanel>
                             <!-- WiFi Name -->
                             <StackPanel Margin="0,0,0,20">
                                 <TextBlock Text="WiFi Name" FontSize="12" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,8"/>
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="Auto"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBox Text="{Binding GeneratedWifiName, Mode=OneWay}" IsReadOnly="True" FontFamily="Segoe UI Emoji" FontSize="32" BorderThickness="0" Background="Transparent" VerticalAlignment="Center"/>
                                     <Button Grid.Column="1" Command="{Binding CopyNameCommand}" Content="Copy" Padding="12,6" FontSize="12" Background="#F0F0F0" Foreground="{StaticResource TextPrimary}"/>
                                 </Grid>
                             </StackPanel>
                             
                             <!-- Password -->
                             <StackPanel Margin="0,0,0,25">
                                 <TextBlock Text="Password" FontSize="12" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,8"/>
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="Auto"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBox Text="{Binding GeneratedPassword, Mode=OneWay}" IsReadOnly="True" FontFamily="Consolas" FontSize="16" BorderThickness="1" Padding="10" Background="#FAFAFA" Foreground="#333"/>
                                     <Button Grid.Column="1" Command="{Binding CopyPasswordCommand}" Content="Copy" Margin="10,0,0,0" Padding="12,6" FontSize="12" Background="#F0F0F0" Foreground="{StaticResource TextPrimary}"/>
                                 </Grid>
                                 <TextBlock Text="{Binding PasswordLengthDescription}" FontSize="12" Foreground="{StaticResource TextSecondary}" Margin="0,4,0,0" HorizontalAlignment="Right"/>
                             </StackPanel>

                             <!-- Action Button -->
                             <Button Command="{Binding GenerateWifiCommand}" Content="✨ Generate New WiFi Identity" HorizontalAlignment="Stretch" Margin="0,0,0,25"/>

                             <!-- QR Code Area -->
                             <Border Background="White" HorizontalAlignment="Center" Padding="15" CornerRadius="12" BorderBrush="#EEEEEE" BorderThickness="1">
                                 <StackPanel>
                                    <Image Source="{Binding QrCodeImage}" Width="160" Height="160" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
                                    <TextBlock Text="Scan to Join" HorizontalAlignment="Center" Margin="0,10,0,0" FontSize="12" Foreground="{StaticResource TextSecondary}"/>
                                 </StackPanel>
                             </Border>

                             <!-- Join Status -->
                             <TextBlock Text="{Binding JoinStatusMessage}" Foreground="Green" HorizontalAlignment="Center" Margin="0,15,0,0" TextWrapping="Wrap" TextAlignment="Center"/>
                         </StackPanel>
                    </Border>
                    
                    <Button Command="{Binding JoinWifiCommand}" Content="Connect to Network" HorizontalAlignment="Center" Background="Transparent" Foreground="{StaticResource AccentColor}" BorderThickness="0" Margin="0,10"/>
                </StackPanel>

                <!-- Password Options Mockup (Placeholder for polishing) -->
                <StackPanel>
                     <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsChecked, ElementName=NavOptions}" Value="True">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    <TextBlock Text="Password Configuration" FontSize="28" FontWeight="SemiBold" Margin="0,0,0,30"/>
                    
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="Length &amp; Complexity" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,20"/>
                            
                            <TextBlock Text="{Binding PasswordLength, StringFormat='Password Length: {0}'}" Margin="0,0,0,10"/>
                            <Slider Minimum="8" Maximum="63" Value="{Binding PasswordLength}" TickFrequency="1" IsSnapToTickEnabled="True" Margin="0,0,0,30"/>
                            
                            <CheckBox Content="Uppercase (A-Z)" IsChecked="{Binding IncludeUpper}" Margin="0,8" FontSize="14"/>
                            <CheckBox Content="Lowercase (a-z)" IsChecked="{Binding IncludeLower}" Margin="0,8" FontSize="14"/>
                            <CheckBox Content="Numbers (0-9)" IsChecked="{Binding IncludeNumbers}" Margin="0,8" FontSize="14"/>
                            <CheckBox Content="Special Characters (!@#$)" IsChecked="{Binding IncludeSpecial}" Margin="0,8" FontSize="14"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
                
                <!-- Combinations View -->
                <StackPanel>
                     <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsChecked, ElementName=NavCombinations}" Value="True">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    
                    <TextBlock Text="Emoji Combinations" FontSize="28" FontWeight="SemiBold" Margin="0,0,0,30"/>
                    <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" Padding="10" Margin="0,0,0,20" Tag="Search combinations..."/>
                    
                    <Border Style="{StaticResource CardStyle}" Padding="0">
                         <ListBox ItemsSource="{Binding FilteredCombinations}" BorderThickness="0" Background="Transparent" Height="500">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding Emojis}" FontSize="28" FontFamily="Segoe UI Emoji" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="{Binding Name}" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="{StaticResource TextPrimary}"/>
                                    </Grid>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </Border>
                </StackPanel>

                 <!-- Import View -->
                <StackPanel>
                     <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsChecked, ElementName=NavImport}" Value="True">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    
                    <TextBlock Text="Import from QR" FontSize="28" FontWeight="SemiBold" Margin="0,0,0,30"/>
                     <Border Style="{StaticResource CardStyle}" Height="300">
                         <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                             <Button Command="{Binding ImportQrCodeCommand}" Content="Select QR Image File" Padding="20,15" FontSize="16"/>
                             <TextBlock Text="Supports .png, .jpg" Margin="0,15,0,0" Foreground="{StaticResource TextSecondary}" HorizontalAlignment="Center"/>
                         </StackPanel>
                     </Border>
                </StackPanel>

            </Grid>
        </Border>
        <!-- EULA Overlay -->
        <Grid Grid.ColumnSpan="2" Background="#99000000" Visibility="{Binding IsEulaVisible, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Border Background="White" CornerRadius="12" Width="500" Height="400" Padding="30" VerticalAlignment="Center" HorizontalAlignment="Center">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.4"/>
                </Border.Effect>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="End User License Agreement" FontSize="20" FontWeight="Bold" Margin="0,0,0,20"/>

                    <ScrollViewer Grid.Row="1" Margin="0,0,0,20" VerticalScrollBarVisibility="Auto">
                        <TextBlock TextWrapping="Wrap" FontSize="14" Foreground="#333">
                            <TextBlock.Text>
                                NOTE: By using this application, you agree to track usage data via Google Analytics (Firebase). This data is used solely to improve the application experience.
                                
                                
                                LICENSE AGREEMENT
                                
                                1. ACCEPTANCE
                                By using EmojiWifi, you agree to be bound by the terms of this agreement.
                                
                                2. DATA COLLECTION
                                This application collects anonymous usage data using Google Analytics for Firebase to help us improve the app. No personally identifiable information (PII) is collected or stored.
                                
                                3. DISCLAIMER
                                THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED.
                                
                                4. TERMINATION
                                You may terminate this agreement at any time by uninstalling the application.
                            </TextBlock.Text>
                        </TextBlock>
                    </ScrollViewer>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="Decline" Command="{Binding DeclineEulaCommand}" Background="Transparent" Foreground="Red" Margin="0,0,10,0"/>
                        <Button Content="I Agree" Command="{Binding AcceptEulaCommand}" Width="100"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>
